-- Wireless Receiver that starts/stops finalscreen.lua properly

local modem = peripheral.wrap("bottom") -- Wireless modem under computer
local channel = 1

if not modem then
    print("No modem found!")
    return
end

modem.open(channel)

local finalscreenRunning = false
local finalscreenTabID = nil

print("Wireless receiver ready.")

while true do
    local event, side, senderChannel, replyChannel, message, distance = os.pullEvent("modem_message")

    if senderChannel == channel and message == "button_pressed" then
        if not finalscreenRunning then
            print("Starting Finalscreen.")
            finalscreenTabID = shell.openTab("finalscreen.lua")
            finalscreenRunning = true
        else
            print("Stopping Finalscreen.")
            if finalscreenTabID then
                -- Stop the finalscreen tab
                shell.kill(finalscreenTabID)
            end
            finalscreenRunning = false
        end
    end
end
