-- Configuration
local targetName = "front" -- Fuel source peripheral side
local monitorSide = "right" -- Fixed monitor side
local updateInterval = 1   -- Seconds between updates
local barWidth = 79        -- Monitor width in characters

-- Wrap peripherals
local monitor = peripheral.wrap(monitorSide)

-- Setup monitor
monitor.setTextScale(1)
monitor.setBackgroundColor(colors.black)
monitor.setTextColor(colors.white)
monitor.clear()

while true do
    monitor.setCursorPos(1, 1)
    monitor.clearLine()
    
    local target = peripheral.wrap(targetName)
    local fuel = nil

    -- Try different methods to get fuel value
    if target and target.getFuelLevel then
        fuel = target.getFuelLevel()
    elseif target and target.getText then
        fuel = tonumber(target.getText()) or 0
    elseif target and target.readAll then
        fuel = tonumber(target.readAll()) or 0
    end

    if fuel then
        fuel = math.max(0, math.min(100, fuel)) -- Clamp to 0–100

        local percentText = string.format(" %3d%%", fuel)
        local barLength = barWidth - #percentText
        local filled = math.floor(barLength * fuel / 100)
        local empty = barLength - filled
        local bar = string.rep("█", filled) .. string.rep("░", empty)

        monitor.write(bar .. percentText)
    else
        monitor.write("No valid fuel value from '" .. targetName .. "'")
    end

    sleep(updateInterval)
end
