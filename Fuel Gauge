-- Configuration
local targetName = "front" -- Peripheral side
local updateInterval = 1   -- Seconds between updates
local barWidth = 79        -- Monitor width (1x4 block = 79 chars wide)
local monitor = peripheral.find("monitor") -- Detect monitor

-- Setup monitor
monitor.setTextScale(1)
monitor.setBackgroundColor(colors.black)
monitor.setTextColor(colors.white)
monitor.clear()

while true do
    monitor.setCursorPos(1, 1)
    monitor.clearLine()
    
    local target = peripheral.wrap(targetName)
    local fuel = nil

    -- Try different methods to get fuel value
    if target and target.getFuelLevel then
        fuel = target.getFuelLevel()
    elseif target and target.getText then
        fuel = tonumber(target.getText()) or 0
    elseif target and target.readAll then
        fuel = tonumber(target.readAll()) or 0
    end

    if fuel then
        fuel = math.max(0, math.min(100, fuel)) -- Clamp between 0-100

        -- Calculate bar
        local percentText = string.format(" %3d%%", fuel)
        local barLength = barWidth - #percentText
        local filled = math.floor(barLength * fuel / 100)
        local empty = barLength - filled
        local bar = string.rep("█", filled) .. string.rep("░", empty)

        -- Draw bar + percent
        monitor.write(bar .. percentText)
    else
        monitor.write("No valid fuel value detected from '" .. targetName .. "'")
    end

    sleep(updateInterval)
end
